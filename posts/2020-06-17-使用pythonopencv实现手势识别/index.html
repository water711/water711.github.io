<!doctype html>
<html lang="en-us">
  <head>
    <title>使用Python&#43;OpenCV实现手势识别 // 蔡振威的博客</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.107.0">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.9e9c6027c30f5aa9423b581bd9cddd1ddc66088adb9c2604f89eb5828efea5a1.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="使用Python&#43;OpenCV实现手势识别"/>
<meta name="twitter:description" content="来源某国外视频：https://www.bilibili.com/video/BV1E4411f7Q1
环境 Python：3.7.0
OpenCV：3.4.3.18
# -*- coding:utf-8 -*-
import cv2 import numpy as np import math cap = cv2.VideoCapture(0)
while(1):
ret, frame = cap.read() frame = cv2.flip(frame,1) kernel = np.ones((3,3), np.uint8) # define region of interest roi = frame\[100:300, 100:300\] cv2.rectangle(frame,(100,100),(300,300),(0,255,0),0) hsv = cv2.cvtColor(roi, cv2.COLOR\_BGR2HSV) # define range of skin color in HSV lower\_skin = np.array(\[0,20,70\], dtype=np.uint8) upper\_skin = np.array(\[20,255,255\], dtype=np.uint8) #extract skin color image mask = cv2.inRange(hsv, lower\_skin, upper\_skin) #extrapolate the hand to fill dark spots within mask = cv2."/>

    <meta property="og:title" content="使用Python&#43;OpenCV实现手势识别" />
<meta property="og:description" content="来源某国外视频：https://www.bilibili.com/video/BV1E4411f7Q1
环境 Python：3.7.0
OpenCV：3.4.3.18
# -*- coding:utf-8 -*-
import cv2 import numpy as np import math cap = cv2.VideoCapture(0)
while(1):
ret, frame = cap.read() frame = cv2.flip(frame,1) kernel = np.ones((3,3), np.uint8) # define region of interest roi = frame\[100:300, 100:300\] cv2.rectangle(frame,(100,100),(300,300),(0,255,0),0) hsv = cv2.cvtColor(roi, cv2.COLOR\_BGR2HSV) # define range of skin color in HSV lower\_skin = np.array(\[0,20,70\], dtype=np.uint8) upper\_skin = np.array(\[20,255,255\], dtype=np.uint8) #extract skin color image mask = cv2.inRange(hsv, lower\_skin, upper\_skin) #extrapolate the hand to fill dark spots within mask = cv2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://water711.github.io/posts/2020-06-17-%E4%BD%BF%E7%94%A8pythonopencv%E5%AE%9E%E7%8E%B0%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-06-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-17T00:00:00+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://water711.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">蔡振威的博客</span>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vehicula turpis sit amet elit pretium.</p>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">使用Python&#43;OpenCV实现手势识别</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 17, 2020
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          3 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>来源某国外视频：<a href="https://www.bilibili.com/video/BV1E4411f7Q1">https://www.bilibili.com/video/BV1E4411f7Q1</a></p>
<h2 id="环境">环境</h2>
<p>Python：3.7.0</p>
<p>OpenCV：3.4.3.18</p>
<p><img src="http://hugo.caizhenwei.top//1111.jpg" alt=""></p>
<p> </p>
<p># -*- coding:utf-8 -*-</p>
<p>import cv2
import numpy as np
import math
cap = cv2.VideoCapture(0)</p>
<p>while(1):</p>
<pre><code>ret, frame = cap.read()
frame = cv2.flip(frame,1)
kernel = np.ones((3,3), np.uint8)

# define region of interest
roi = frame\[100:300, 100:300\]

cv2.rectangle(frame,(100,100),(300,300),(0,255,0),0)
hsv = cv2.cvtColor(roi, cv2.COLOR\_BGR2HSV)

# define range of skin color in HSV
lower\_skin = np.array(\[0,20,70\], dtype=np.uint8)
upper\_skin = np.array(\[20,255,255\], dtype=np.uint8)

#extract skin color image
mask = cv2.inRange(hsv, lower\_skin, upper\_skin)

#extrapolate the hand to fill dark spots within
mask = cv2.dilate(mask,kernel,iterations = 4)

#blur the image
mask = cv2.GaussianBlur(mask,(5,5),100)

#find contours
\_, contours, hierarchy = cv2.findContours(mask, cv2.RETR\_TREE, cv2.CHAIN\_APPROX\_SIMPLE)

#find contour of max area(hand)
cnt = max(contours, key = lambda x: cv2.contourArea(x))

#apprax the contour a little
epsilon = 0.0005\*cv2.arcLength(cnt,True)
approx = cv2.approxPolyDP(cnt,epsilon,True)

#make convex hull around hand
hull = cv2.convexHull(cnt)

#define area of hull and area of hand
areahull = cv2.contourArea(hull)
areacnt = cv2.contourArea(cnt)

#find the percentage of area not covered by hand in convex hull
arearatio = ((areahull-areacnt)/areacnt)\*100

#find the defects in convex hull with respect to hand
hull = cv2.convexHull(approx, returnPoints=False)
defects = cv2.convexityDefects(approx, hull)

#i = no. of defects
l=0

#code for finding no of defects due to fingers
for i in range(defects.shape\[0\]):
    s,e,f,d = defects\[i,0\]
    start = tuple(approx\[s\]\[0\])
    end = tuple(approx\[e\]\[0\])
    far = tuple(approx\[f\]\[0\])
    pt = (100,100)

    #find lergth of all sides of triungle
    a = math.sqrt((end\[0\] - start\[0\])\*\*2 + (end\[1\] - start\[1\])\*\*2)
    b = math.sqrt((far\[0\] - start\[0\])\*\*2 + (far\[1\] - start\[1\])\*\*2)
    c = math.sqrt((end\[0\] - far\[0\])\*\*2 + (end\[1\] - far\[1\])\*\*2)
    s = (a+b+c)/2
    ar = math.sqrt(s\*(s-a)\*(s-b)\*(s-c))

    #distance between point and convex hull
    d = (2\*ar)/a

    # apply consine rule here
    angle = math.acos((b\*\*2 + c\*\*2 - a\*\*2)/(2\*b\*c)) \* 57

    # ignore anggles &gt; 90 and ignore points very close to convex hull
    if angle &lt;= 90 and d&gt;30:
        l += 1
        cv2.circle(roi, far, 3, \[255,0,0\], -1)

    #draw lines around hand
        cv2.line(roi, start, end, \[0,255,0\], 2)

l+=1

#print corresponding gestures which are in their ranges
font = cv2.FONT\_HERSHEY\_SIMPLEX
if l==1:
    if areacnt&lt;20000:
        cv2.putText(frame, 'Put hand in the box',(0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)
    else:
        if arearatio&lt;12:
            cv2.putText(frame, '0',(0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)
        elif arearatio&lt;17.5:
            cv2.putText(frame, 'Best of luck', (0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)

        else:
            cv2.putText(frame, '1',(0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)

elif l==2:
    cv2.putText(frame, '2',(0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)

elif l==3:

    if arearatio&lt;27:
        cv2.putText(frame, '3', (0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)
    else:
        cv2.putText(frame, 'ok', (0,50), font, 2, (0,0,255), 3, cv2.LINE\_AA)

elif l==4:
    cv2.putText(frame, '4', (0, 50), font, 2, (0, 0, 255), 3, cv2.LINE\_AA)

elif l == 5:
    cv2.putText(frame, '5', (0, 50), font, 2, (0, 0, 255), 3, cv2.LINE\_AA)

elif l == 4:
    cv2.putText(frame, '5', (0, 50), font, 2, (0, 0, 255), 3, cv2.LINE\_AA)

elif l == 4:
    cv2.putText(frame, 'reposition', (0, 50), font, 2, (0, 0, 255), 3, cv2.LINE\_AA)

else:
    cv2.putText(frame, 'reposition', (10, 50), font, 2, (0, 0, 255), 3, cv2.LINE\_AA)

#show the windows
cv2.imshow('mask', mask)
cv2.imshow('frame', frame)

k = cv2.waitKey(25) &amp; 0xFF
if k == 27:
    break
</code></pre>
<p>cv2.destroyAllwindows()
cap.release()</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
